(this["webpackJsonpexercice-kasual-business"]=this["webpackJsonpexercice-kasual-business"]||[]).push([[0],{17:function(e,t,n){},20:function(e,t,n){e.exports=n.p+"static/media/loading.61c188cc.gif"},21:function(e,t,n){e.exports=n(29)},26:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),l=(n(26),n(8)),s=n(9),u=n(7),c=n(11),h=n(10),m=(n(17),n(32)),d=n(33),p=n(31),g=n(34),v=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).state={zoom:5},e}return Object(s.a)(n,[{key:"render",value:function(){return r.a.createElement(m.a,{center:this.props.position,zoom:this.state.zoom},r.a.createElement(d.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.measurements.map((function(e,t){if(!e.coordinates.longitude||!e.coordinates.latitude)return null;var n=[e.coordinates.latitude,e.coordinates.longitude];return r.a.createElement(p.a,{key:t,position:n},r.a.createElement(g.a,{key:t},r.a.createElement("b",null,"Location")," : ",e.city," ",r.a.createElement("br",null),r.a.createElement("b",null,"Date")," : ",e.date.local," ",r.a.createElement("br",null),r.a.createElement("b",null,"Value")," : ",e.value," ",e.unit))})))}}]),n}(r.a.Component),f=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).state={value:"FR"},e.handleChange=e.handleChange.bind(Object(u.a)(e)),e}return Object(s.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value}),this.props.handleCountryChange(e.target.value)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("select",{name:"countries",id:"countries",onChange:this.handleChange,value:this.state.value},this.props.countries.map((function(e,t){var n=e.name,a=e.code;return r.a.createElement("option",{key:t,value:a},n||a)}))))}}]),n}(r.a.Component),b=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).state={value:0},e.handleChange=e.handleChange.bind(Object(u.a)(e)),e}return Object(s.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value}),this.props.handleValueChange(e.target.value)}},{key:"componentDidMount",value:function(){this.setState({value:this.props.defaultValue})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("label",{htmlFor:this.props.name},this.props.name.charAt(0).toUpperCase()+this.props.name.slice(1),r.a.createElement("input",{type:"number",name:this.props.name,value:this.state.value,onChange:this.handleChange})))}}]),n}(r.a.Component),C=n(20),y=n.n(C),E=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).state={lat:0,lng:0,measurements:{},countries:[],loading:!1},e.from=0,e.to=100,e.countryCode="FR",e.handleCountryChange=e.handleCountryChange.bind(Object(u.a)(e)),e.handleFromChange=e.handleFromChange.bind(Object(u.a)(e)),e.handleToChange=e.handleToChange.bind(Object(u.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(u.a)(e)),e}return Object(s.a)(n,[{key:"fetchMeasurements",value:function(e,t,n){var a=this,r="https://api.openaq.org/v1/measurements?country="+e+"&value_from="+t+"&value_to="+n;console.log(r),fetch(r).then((function(e){return e.json()})).then((function(e){return a.setState({measurements:e.results,lat:e.results[0]?e.results[0].coordinates.latitude:0,lng:e.results[0]?e.results[0].coordinates.longitude:0})})).then((function(){a.setState({loading:!1})}))}},{key:"handleCountryChange",value:function(e){this.countryCode=e}},{key:"handleFromChange",value:function(e){this.from=e}},{key:"handleToChange",value:function(e){this.to=e}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({loading:!0}),this.fetchMeasurements(this.countryCode,this.from,this.to)}},{key:"componentDidMount",value:function(){var e=this;fetch("https://api.openaq.org/v1/countries").then((function(e){return e.json()})).then((function(t){return e.setState({countries:t.results})})),this.fetchMeasurements("FR",0,100)}},{key:"render",value:function(){var e,t,n=[null!==(e=this.state.lat)&&void 0!==e?e:0,null!==(t=this.state.lng)&&void 0!==t?t:0],a=[],o=[];return this.state.measurements[0]&&(a=this.state.measurements),this.state.countries[0]&&(o=this.state.countries),r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{measurements:a,position:n}),r.a.createElement("div",{id:"filters"},r.a.createElement(f,{countries:o,handleCountryChange:this.handleCountryChange}),r.a.createElement(b,{name:"from",defaultValue:0,handleValueChange:this.handleFromChange}),r.a.createElement(b,{name:"to",defaultValue:100,handleValueChange:this.handleToChange}),r.a.createElement("button",{onClick:this.handleSubmit},"Apply filters"),this.state.loading?r.a.createElement("img",{src:y.a,alt:"spinner gif",height:"50px"}):""))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.76621889.chunk.js.map